<template name="sources_show_format_page">
  {{#with source}}
    {{#if currentImportFlow}}
    <section class='edit-stream-chain'>
      <section class='stream-chain'>
        <ul class="source-import-flows-tabs">
          {{#each getImportFlows}}
            <li {{getClassNameForImportFlowListItem _id}}>
              <a
                href="{{pathFor
                          route='sources.show.format.for_import_flow'
                          _id=sourceId
                          import_flow_index=urlIndex
                      }}">
                {{name}}
              </a>
            </li>
          {{/each}}
        </ul>

        <textarea class='code code-block' id='importFlow'>{{stringify currentImportFlow.streams}}</textarea>
        <ul class='import-flow-errors is-empty'></ul>
      </section>

      <aside>
        <div class="import-flow-actions">
          <div class="import-flow-help-wrapper">
            <button>&#xE80A;</button>
            <div class="import-flow-help">
              {{> import_flow_help }}
            </div>
          </div>
          {{#if getNotificationsForImportFlow.length}}
            <div class="import-flow-notifications-wrapper">
              <button>&#xE816;</button>
              <div class="import-flow-notifications">
                {{#each getNotificationsForImportFlow}}
                  <p>
                    {{{this}}}
                  </p>
                {{/each}}
              </div>
            </div>
          {{/if}}
          <div class="import-flow-file-uploader-wrapper">
            &#xE815;
            {{> fileUpload
                  additionalCSSClasses='import-flow-file-uploader'
                  accept=source.currentImportFlow.inputMimeType
                  metadata=fileMetadata
                  callbacks=fileCallbacks
            }}
          </div>
          <button class="js-start-import">&#x31;</button>
        </div>

        {{#with lastSourceImport}}
          {{> sources_stream_chain}}
        {{else}}
          <h2>{{_"Latest Import"}}</h2>
          <p class='placeholder'>{{_"Here you will see your last imports"}}</p>
        {{/with}}
      </aside>
    </section>
    {{else}}
      <section class='page-content centered load-default-json'>
        <div class='block'>
          <h1>Select your data format</h1>
          <p>
            <form>
            <table class='formats'>
              <tbody>
                {{#each keyValues importFlowTemplates}}
                  <tr>
                    <td>
                      <label>
                        <input name='format' type='radio' value='{{key}}'>&nbsp;{{value.name}}
                      </label>
                    </td>
                    <td>
                      {{#markdown}}{{value.descriptionMarkdown}}{{/markdown}}
                    </td>
                  </tr>
                {{/each}}
              </tbody>
            </table>
            <button class='btn btn-primary js-set-format'>Set format</button>
            </form>
          </p>

          <p>
            Your format is not listed here or more complex? Feel free to <a href='mailto:support@accessibility.cloud'>contact us</a> so we can assist you with the setup. ‚úåüèº
          </p>
        </div>
      </section>
    {{/if}}
  {{/with}}
</template>
